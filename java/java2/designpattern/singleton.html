<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>单例模式的几种实现方式 | 笔记记录</title>
    <meta name="generator" content="VuePress 1.6.0">
    
    <meta name="description" content="笔记记录">
    <link rel="preload" href="/assets/css/0.styles.e95cc0cd.css" as="style"><link rel="preload" href="/assets/js/app.5b872484.js" as="script"><link rel="preload" href="/assets/js/2.95b5d4e7.js" as="script"><link rel="preload" href="/assets/js/28.ee5daedd.js" as="script"><link rel="preload" href="/assets/js/5.e24b865d.js" as="script"><link rel="prefetch" href="/assets/js/10.e4b342a4.js"><link rel="prefetch" href="/assets/js/11.bd40864c.js"><link rel="prefetch" href="/assets/js/12.ac7c6185.js"><link rel="prefetch" href="/assets/js/13.0f9e5aec.js"><link rel="prefetch" href="/assets/js/14.c5bd594f.js"><link rel="prefetch" href="/assets/js/15.4ec7af9d.js"><link rel="prefetch" href="/assets/js/16.1d4df6e7.js"><link rel="prefetch" href="/assets/js/17.81008e40.js"><link rel="prefetch" href="/assets/js/18.024b4f20.js"><link rel="prefetch" href="/assets/js/19.bf670a4c.js"><link rel="prefetch" href="/assets/js/20.7f895870.js"><link rel="prefetch" href="/assets/js/21.1063093a.js"><link rel="prefetch" href="/assets/js/22.27a600df.js"><link rel="prefetch" href="/assets/js/23.99a7e995.js"><link rel="prefetch" href="/assets/js/24.a693b450.js"><link rel="prefetch" href="/assets/js/25.0aded761.js"><link rel="prefetch" href="/assets/js/26.577ca356.js"><link rel="prefetch" href="/assets/js/27.b5626320.js"><link rel="prefetch" href="/assets/js/29.d88ddc87.js"><link rel="prefetch" href="/assets/js/3.616127a8.js"><link rel="prefetch" href="/assets/js/30.9cd17172.js"><link rel="prefetch" href="/assets/js/31.19b4a967.js"><link rel="prefetch" href="/assets/js/32.7cf919b3.js"><link rel="prefetch" href="/assets/js/33.54013d34.js"><link rel="prefetch" href="/assets/js/34.c39b0ff0.js"><link rel="prefetch" href="/assets/js/35.df4dd8ba.js"><link rel="prefetch" href="/assets/js/36.8bdf8db9.js"><link rel="prefetch" href="/assets/js/37.f56aea70.js"><link rel="prefetch" href="/assets/js/38.dd00850a.js"><link rel="prefetch" href="/assets/js/39.196e4a73.js"><link rel="prefetch" href="/assets/js/4.4424bfaf.js"><link rel="prefetch" href="/assets/js/40.bf971ac9.js"><link rel="prefetch" href="/assets/js/41.34ac431e.js"><link rel="prefetch" href="/assets/js/42.271a0146.js"><link rel="prefetch" href="/assets/js/43.e6f0364c.js"><link rel="prefetch" href="/assets/js/44.43402a44.js"><link rel="prefetch" href="/assets/js/45.53109ce4.js"><link rel="prefetch" href="/assets/js/46.71c83bcb.js"><link rel="prefetch" href="/assets/js/47.3330909b.js"><link rel="prefetch" href="/assets/js/48.5d9748c2.js"><link rel="prefetch" href="/assets/js/49.ea99f55e.js"><link rel="prefetch" href="/assets/js/6.e40e6cce.js"><link rel="prefetch" href="/assets/js/7.e4b3e82e.js"><link rel="prefetch" href="/assets/js/8.4da51d7f.js"><link rel="prefetch" href="/assets/js/9.d7c3507a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e95cc0cd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">笔记记录</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博文" class="dropdown-title"><span class="title">博文</span> <span class="arrow down"></span></button> <button type="button" aria-label="博文" class="mobile-dropdown-title"><span class="title">博文</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/element/" class="nav-link">
  Element
</a></li><li class="dropdown-item"><!----> <a href="/java/" class="nav-link router-link-active">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/other/" class="nav-link">
  Other
</a></li><li class="dropdown-item"><!----> <a href="/problem/" class="nav-link">
  Problem
</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记精选汇总" class="dropdown-title"><span class="title">笔记精选汇总</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记精选汇总" class="mobile-dropdown-title"><span class="title">笔记精选汇总</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dongjianOne" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub 站
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developer.aliyun.com/mirror/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里云官方镜像站
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/dongjianOne/dongjianOne.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博文" class="dropdown-title"><span class="title">博文</span> <span class="arrow down"></span></button> <button type="button" aria-label="博文" class="mobile-dropdown-title"><span class="title">博文</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/element/" class="nav-link">
  Element
</a></li><li class="dropdown-item"><!----> <a href="/java/" class="nav-link router-link-active">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/other/" class="nav-link">
  Other
</a></li><li class="dropdown-item"><!----> <a href="/problem/" class="nav-link">
  Problem
</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记精选汇总" class="dropdown-title"><span class="title">笔记精选汇总</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记精选汇总" class="mobile-dropdown-title"><span class="title">笔记精选汇总</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dongjianOne" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub 站
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://developer.aliyun.com/mirror/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里云官方镜像站
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/dongjianOne/dongjianOne.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JAVA知识点</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>java基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>java设计模式</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java/java2/designpattern/singleton.html" aria-current="page" class="active sidebar-link">单例模式的几种实现方式</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>java工具</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="单例模式的几种实现方式"><a href="#单例模式的几种实现方式" class="header-anchor">#</a> 单例模式的几种实现方式</h1> <h3 id="_1-普通懒汉模式"><a href="#_1-普通懒汉模式" class="header-anchor">#</a> 1.普通懒汉模式</h3> <p>说明：访问效率高，延迟初始化，用到时再创建资源利用率高，但是非线程安全</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * 懒汉式:访问效率高，延迟初始化，用到时再创建资源利用率高，但是非线程安全
 */</span>
<span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">SingletonLazy</span> <span class="token punctuation">{</span>
    <span class="token comment">//1.定义一个静态的实例对象</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SingletonLazy</span> instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token comment">//2.私有构造方法，不允许外部直接new对象</span>
    <span class="token keyword">private</span> <span class="token class-name">SingletonLazy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//3.全局的访问方法</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">SingletonLazy</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonLazy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-普通饿汉模式"><a href="#_2-普通饿汉模式" class="header-anchor">#</a> 2.普通饿汉模式</h3> <p>说明：访问性能高，线程安全，但是初始化即创建会造成一定的资源浪费</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* 饿汉式:访问性能高，线程安全(JDK)，但是初始化即创建会造成一定的资源浪费
*/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>
    <span class="token comment">//1.定义一个静态的实例对象，类加载时初始化</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//2.私有的构造方法，不允许外部直接new对象</span>
    <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//3.提供一个全局的访问方法</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-懒汉式-双检锁-volatile"><a href="#_3-懒汉式-双检锁-volatile" class="header-anchor">#</a> 3.懒汉式+双检锁+volatile</h3> <p>说明：访问性能好,延迟初始化,线程安全(volatile+synchronized)</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * 懒汉式+DoubleCheck+volatile --访问性能好 延迟初始化 线程安全
 */</span>
<span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">SingletonDoubleCheck</span><span class="token punctuation">{</span>
    <span class="token comment">//定义一个静态的实例对象</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">volatile</span> <span class="token class-name">SingletonDoubleCheck</span> instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">//定义私有构造方法，不允许外界直接new 对象</span>
    <span class="token keyword">private</span> <span class="token class-name">SingletonDoubleCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">//提供全局的访问方法</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SingletonDoubleCheck</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">SingletonDoubleCheck</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">// Double Check -- 第一个线程已经创建对象了，instance不为null,此时不应该再创建对象</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonDoubleCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-静态内部类-推荐"><a href="#_4-静态内部类-推荐" class="header-anchor">#</a> 4.静态内部类(推荐)</h3> <p>说明：访问性能好 延迟初始化 线程安全(JDK/JVM加载机制)</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * 内部类 访问性能好 延迟初始化 线程安全
 */</span>
<span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">SingtonByHolder</span><span class="token punctuation">{</span>
    <span class="token comment">// 内部类持有SingtonByHolder对象，类加载机制决定一个类只能被初始化一次</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Holder</span><span class="token punctuation">{</span>
        <span class="token comment">// 多线程情况下也只会有一个实例</span>
        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SingtonByHolder</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingtonByHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//私有的构造方法，不允许外部直接new 对象</span>
    <span class="token keyword">private</span> <span class="token class-name">SingtonByHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">SingtonByHolder</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Holder</span><span class="token punctuation">.</span>instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="静态内部类的优点"><a href="#静态内部类的优点" class="header-anchor">#</a> 静态内部类的优点</h3> <p>静态内部类的优点是：外部类加载时并不需要立即加载内部类，内部类不被加载则不去初始化INSTANCE，故而不占内存。
具体来说当SingleTon第一次被加载时，并不需要去加载SingleTonHoler，只有当getInstance()方法第一次被调用时，
使用INSTANCE的时候,才会导致虚拟机加载SingleTonHoler类。这种方法不仅能确保线程安全，也能保证单例的唯一性，同时也延迟了单例的实例化。</p> <h3 id="类的初始化"><a href="#类的初始化" class="header-anchor">#</a> 类的初始化</h3> <p>比如有一个类T，那么什么时候会进行类T的初始化？有以下5种情况：</p> <div class="language- extra-class"><pre><code>T 是一个类，而且一个 T 类型的实例被创建；
T 是一个类，且 T 中声明的一个静态方法被调用；
T 中声明的一个静态字段被赋值；
T 中声明的一个静态字段被使用，而且这个字段不是一个常量字段；
T 是一个顶级类（top level class，见 java 语言规范的§7.6），而且一个断言语句嵌套在 T 内部被执行。
</code></pre></div><p>而我们前面的代码则对应了第四种情况，一个静态字段被使用，因此此时则会进行静态内部类的初始化。又因为java是多线程语言，
作者也考虑到了可能存在“多个线程在同一时间尝试去初始化同一个类”的情况，因此java规定，<strong>对于每一个类或接口 C，都有一个唯一的初始化锁 LC 与之对应</strong>。</p> <p><strong>JVM 在类初始化期间会获取这个初始化锁，并且每个线程至少获取一次锁来确保这个类已经被初始化过了。（但是只有第一个获得锁的线程，会执行初始化，执行完之后会设置一个标志位，表示已经初始化完成，后面其他的线程再次获得锁，检查标志位，发现已经初始化完了，直接释放锁，不会再次执行初始化。）</strong></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dongjianOne/dongjianOne.github.io/edit/master/docs/java/java2/designpattern/singleton.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新 :</span> <span class="time">2021/2/28 上午9:47:42</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/java/java2/interview/Decoupling.html" class="prev">
        我们经常说高内聚第低耦合，那什么是耦合？又如何解耦呢？
      </a></span> <span class="next"><a href="/java/java2/tools/Knife4j.html">
        Swagger增强工具 Knife4j
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.5b872484.js" defer></script><script src="/assets/js/2.95b5d4e7.js" defer></script><script src="/assets/js/28.ee5daedd.js" defer></script><script src="/assets/js/5.e24b865d.js" defer></script>
  </body>
</html>
